
@{
    ViewData["Title"] = "A";
    Layout = "/Views/Appointment/_Layout.cshtml";
}


<div id="login">
    <h3 class="text-center text-white pt-5">Visitor Form</h3>
    <div class="container">
        <div id="login-row" class="row justify-content-center align-items-center">
            <div id="login-column" class="col-md-6">
                <div id="login-box" class="col-md-12">
                    <div id="login-form" class="form">

                        <div id="firstForm">
                            <h3 class="text-center text-info">Welcome!</h3>

                            <div class="form-group">
                                <label for="username" class="text-info">Please enter your number:</label><br>
                                <input type="text" id="phoneNumber" class="form-control">
                                <span class="text-danger" id="val_PhoneNumber" style="display:none;">Please enter your number</span>
                            </div>

                            <div class="form-group">
                                <button onclick="btnNext(1)" type="button" class="btn btn-info btn-md col-md-12">Next</button>
                            </div>

                        </div>

                        <div id="SecondForm" style="display:none;">
                            <h3 class="text-center text-info">Welcome!</h3>

                            <div class="form-group">
                                <label for="username" class="text-info">Enter Your Full Name:</label><br>
                                <input type="text" class="form-control" id="formFullName" />
                                <span class="text-danger" id="val_FullName" style="display:none;">Please enter your full name</span>
                            </div>

                            <div class="form-group">
                                <label for="username" class="text-info">Enter Your Company Name:</label><br>
                                <input type="text" class="form-control" id="company" />
                                <span class="text-danger" id="val_CompanyName" style="display:none;">Please enter your company name</span>
                            </div>

                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(2)" type="button" class="btn btn-info col-12">Next <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="ThirdForm" style="display:none;">
                            <h3 class="text-center text-info">What is the purpose of your visit!</h3>
                            <span class="text-danger" id="val_Purpose" style="display: table; margin: 0 auto; display:none;">Please choose your purpose</span>

                            <div class="row mb-4 mt-4">
                                <div class="col-md-4">
                                    <button onclick="btnMeetingPurpose(1)" id="btnOptionOne" type="button" class="btn btn-info col-12">Meeting</button>
                                </div>

                                <div class="col-md-4">
                                    <button onclick="btnMeetingPurpose(2)" id="btnOptionTwo" type="button" class="btn btn-info col-12">Contractor</button>
                                </div>

                                <div class="col-md-4">
                                    <button onclick="btnMeetingPurpose(3)" id="btnOptionThree" type="button" class="btn btn-info col-12">Other</button>
                                </div>

                            </div>


                            <div class="form-group" id="OtherReason" style="display:none;">
                                <label for="username" class="text-info">Your other reason:</label><br>
                                <input type="text" class="form-control" id="otherReason" />
                                <span class="text-danger" id="val_Reason" style="display:none">Reason is required</span>
                            </div>



                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(3)" type="button" class="btn btn-info col-12">Next <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="FourthForm" style="display:none;">
                            <h3 class="text-center text-info">Welcome!</h3>




                            <div class="form-group" id="OtherReason">
                                <label for="username" class="text-info">Car Registration Number:</label><br>
                                <input type="text" class="form-control" id="carRegistrationNumber" />
                                <span class="text-danger" id="val_CarRegistration" style="display:none">Please enter your car registration number</span>
                            </div>



                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(4)" type="button" class="btn btn-info col-12">Next <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="FiftForm" style="display:none;">
                            <h3 class="text-center text-info">Add a photo</h3>

                            <div class="form-group text-center">
                                <img id="profileImage" src="https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png" style="height:100px; width:100px;" class="rounded-circle" alt="Cinque Terre">
                            </div>

                            <div class="form-group">


                                <div class="row">


                                    <div class="col-md-12 text-center">
                                        <button type="button" id="takePhoto" class="btn btn-info col-4 text-center"><i class="fas fa-camera-retro"></i>&nbsp; Take Photo </button>
                                        <input type="file" style="display:none" id="openFile" onchange="previewFile(this);" />
                                    </div>
                                </div>
                            </div>




                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(5)" type="button" class="btn btn-info col-12">Skip <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="SixthForm" style="display:none;">
                            <h3 class="text-center text-info">Please read & acknowledge</h3>


                            <div class="form-group" style="height:200px; overflow:scroll;">
                                <p>Welcome to our workspace</p>

                                <ul>
                                    <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                                    <li>Curabitur non quam cursus lorem aliquam sollicitudin.</li>
                                    <li>Maecenas at neque vitae orci accumsan eleifend ac a ligula.</li>
                                </ul>
                                <ul>
                                    <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                                    <li>Curabitur non quam cursus lorem aliquam sollicitudin.</li>
                                    <li>Maecenas at neque vitae orci accumsan eleifend ac a ligula.</li>
                                </ul>


                                <ul>
                                    <li>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</li>
                                    <li>Curabitur non quam cursus lorem aliquam sollicitudin.</li>
                                    <li>Maecenas at neque vitae orci accumsan eleifend ac a ligula.</li>
                                </ul>



                            </div>




                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(6)" type="button" class="btn btn-info col-12">Acknowledge <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="SeventhForm" style="display:none;">
                            <h5 class="text-center text-info">Please review your visitor record and select : <span class="text-danger">Proceed</span></h5>


                            <div class="form-group">

                                <ul class="list-group">
                                    <li class="list-group-item">Full Name : <span id="setFullName"></span>  <button class="btn btn-primary float-right" onclick="jumpToForm(2)">Edit</button> </li>
                                    <li class="list-group-item">Company Name : <span id="setCompany"></span> <button class="btn btn-primary float-right" onclick="jumpToForm(2)">Edit</button></li>
                                    <li class="list-group-item">Phone Number : <span id="setPhone"></span> <button class="btn btn-primary float-right" onclick="jumpToForm(1)">Edit</button></li>
                                    <li class="list-group-item">Purpose of visit : <span id="setMeeting"></span> <button class="btn btn-primary float-right" onclick="jumpToForm(3)">Edit</button></li>
                                    <li class="list-group-item">Car Registration Number : <span id="setRegistration"></span> <button class="btn btn-primary float-right" onclick="jumpToForm(4)">Edit</button></li>
                                </ul>

                            </div>




                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(7)" type="button" class="btn btn-info col-12">Procced <i class="fas fa-forward"></i>&nbsp;</button>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div id="EightForm" style="display:none;">
                            <h5 class="text-center text-info" id="setEndFullName">Welcome John Doe</h5>


                            <div class="card bg-success" style="color:white;">
                                <div class="card-body text-center">
                                    <i class="fas fa-sign-out-alt mb-5" style="font-size: 58px;"></i>
                                    <h6>You have succesfully check in</h6>
                                </div>
                            </div>

                            <br />

                            <div class="text-center">
                                <span>@DateTime.Now.Date.ToString("hh:mm tt dddd dd MMMM yyyy")</span>
                            </div>

                            <br />


                            <div class="form-group">


                                <div class="row">
                                    <div class="col-md-6">
                                        <button onclick="btnPrev()" type="button" class="btn btn-danger col-12"><i class="fas fa-backward"></i>&nbsp; Previous</button>
                                    </div>

                                    <div class="col-md-6">
                                        <button onclick="btnNext(8)" id="btnDone" type="button" class="btn btn-info col-12"><i class="fas fa-check"></i>&nbsp;Done </button>
                                    </div>
                                </div>
                            </div>

                        </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->

<script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
<script>

    var stepNumber = 1;
    var meetingType = 0;
    var selectedOption = [];

    function btnNext(formNumber) {



        let phoneNumber = $("#phoneNumber").val();
        let fullName = $("#formFullName").val();
        let companyName = $("#company").val();
        let otherReason = $("#otherReason").val();
        let carRegistrationNumber = $("#carRegistrationNumber").val();



        let isRunned = false;

        if (formNumber == 1) {
            if (phoneNumber === '') {
                $('#val_PhoneNumber').show();
                return;
            } else {
                $('#val_PhoneNumber').hide();
            }
        }

        if (formNumber == 2) {
            if (fullName === '') {
                $('#val_FullName').show();
                return;
            } else {
                $('#val_FullName').hide();
            }

            if (companyName === '') {
                $('#val_CompanyName').show();
                return;
            } else {
                $('#val_CompanyName').hide();

            }
        }

        if (formNumber == 3) {
            if (meetingType == 0) {
                $("#val_Purpose").show();
                return;
            } else {
                $("#val_Purpose").hide();
            }

            if (meetingType == 3) {
                if (otherReason === '') {
                    $("#val_Reason").show();
                    return;
                } else {
                    $("#val_Reason").hide();
                }
            }
        }

        if (formNumber == 4) {
            if (meetingType == 0) {
                $("#val_Purpose").show();
                return;
            } else {
                $("#val_Purpose").hide();
            }

            if (meetingType == 3) {
                if (otherReason === '') {
                    $("#val_Reason").show();
                    return;
                } else {
                    $("#val_Reason").hide();
                }
            }
        }

        if (formNumber == 5) {
            if (carRegistrationNumber == '') {
                $('#val_CarRegistration').show();
                return;
            } else {
                $('#val_CarRegistration').hide();
            }
        }

        if (formNumber == 6) {
            $("#setFullName").text(fullName);
            $("#setCompany").text(companyName);
            $("#setPhone").text(phoneNumber);
            $("#setRegistration").text(carRegistrationNumber);

            if (meetingType == 1) {
                //Meeting
                $("#setMeeting").text("Meeting");
            }

            if (meetingType == 2) {
                //Contractor
                $("#setMeeting").text("Contractor");
            }

            if (meetingType == 3) {
                //other
                $("#setMeeting").text("other Reason");
            }



        }

        if (formNumber == 8) {
            



            var input = document.getElementById('openFile');
            var files = input.files;
            var formData = new FormData();

            formData.append("file", files[0]);

            $.ajax(
                {
                    url: "@Url.Action("UploadImage", "Appointment")",
                    data: formData,
                    processData: false,
                    contentType: false,
                    type: "POST",
                    success: function (data) {
                        console.log(data);

                         

                        var row = {
                            FullName: $("#formFullName").val(),
                            PhoneNumber: phoneNumber,
                            CompanyName: companyName,
                            MeetingPurpose: meetingType,
                            MeetingDescription: otherReason,
                            CarRegistration: carRegistrationNumber,
                            PhotoName: data == undefined ? null : data.fileName
                        };

                        console.log(row);




                        $.ajax({
                            type: "POST",
                            url: "@Url.Action("AddAppoitment", "Appointment")",
                            data: { appointment: row },
                            success: function (response) {

                                if (response == "Done") {
                                    stepNumber = 1;
                                    meetingType = 0;

                                    $("#phoneNumber").val('');
                                    $("#formFullName").val('');
                                    $("#company").val('');
                                    $("#otherReason").val('');
                                    $("#carRegistrationNumber").val('');
                                    $("#OtherReason").hide();
                                    $("#btnOptionOne").css({ "backgroundColor": "#17a2b8" });
                                    $("#btnOptionTwo").css({ "backgroundColor": "#17a2b8" });
                                    $("#btnOptionThree").css({ "backgroundColor": "#17a2b8" });
                                    $("#openFile").val('');
                                    $("#profileImage").attr("src", "https://upload.wikimedia.org/wikipedia/commons/7/7c/Profile_avatar_placeholder_large.png");

                                    $("#EightForm").hide();
                                    $("#firstForm").show();
                                    return;
                                }

                            },
                            failure: function (response) {
                                console.error(response.responseText);
                            },
                            error: function (response) {
                                console.error(response.responseText);
                            }
                        })


                    }
                }
            );





          
            return;
           


        }


        stepNumber = stepNumber + 1;

        if (stepNumber == 1) {


            $("#firstForm").show();
            $("#SecondForm").hide();
        }

        if (stepNumber == 2) {



            $("#firstForm").hide();
            $("#SecondForm").show();
        }


        if (stepNumber == 3) {
            console.log("Run");


            $("#SecondForm").hide();
            $("#ThirdForm").show();
        }

        if (stepNumber == 4) {
            console.log("Run");


            $("#ThirdForm").hide();
            $("#FourthForm").show();
        }

        if (stepNumber == 5) {

            console.log("Run");


            $("#FourthForm").hide();
            $("#FiftForm").show();
        }

        if (stepNumber == 6) {
            console.log("Run");



            $("#FiftForm").hide();
            $("#SixthForm").show();
        }

        if (stepNumber == 7) {
            console.log("Run");


            $("#SixthForm").hide();
            $("#SeventhForm").show();
        }

        if (stepNumber == 8) {
            console.log("Run");

            $("#setEndFullName").text(`Welcome ${fullName}`);

            $("#SeventhForm").hide();
            $("#EightForm").show();
        }


        if (stepNumber == 9) {
            stepNumber = 8;
        }


    }

    function btnPrev() {
        console.log(stepNumber);
        if (stepNumber == 1) {
            $("#firstForm").hide();
            $("#SecondForm").show();
        }

        if (stepNumber == 2) {
            $("#firstForm").show();
            $("#SecondForm").hide();
            stepNumber = 1;
        }

        if (stepNumber == 3) {
            $("#SecondForm").show();
            $("#ThirdForm").hide();
            stepNumber = 2;
        }

        if (stepNumber == 4) {
            $("#ThirdForm").show();
            $("#FourthForm").hide();
            stepNumber = 3;
        }

        if (stepNumber == 5) {
            $("#FourthForm").show();
            $("#FiftForm").hide();
            stepNumber = 4;
        }

        if (stepNumber == 6) {
            $("#FiftForm").show();
            $("#SixthForm").hide();
            stepNumber = 5;
        }

        if (stepNumber == 7) {
            $("#SixthForm").show();
            $("#SeventhForm").hide();
            stepNumber = 6;
        }
    }

    function jumpToForm(FormNumber) {

        $("#SeventhForm").hide();


        if (FormNumber == 1) {
            $("#firstForm").show();
            stepNumber = 1;
        }

        if (FormNumber == 2) {
            $("#SecondForm").show();
            stepNumber = 2;
        }

        if (FormNumber == 3) {
            $("#ThirdForm").show();
            stepNumber = 3;
        }

        if (FormNumber == 4) {
            $("#FourthForm").show();
            stepNumber = 4;
        }

        if (FormNumber == 5) {
            $("#FiftForm").show();
            stepNumber = 5;
        }

        if (FormNumber == 6) {
            $("#SixthForm").show();
            stepNumber = 6;
        }

        if (FormNumber == 7) {
            $("#SeventhForm").show();
            stepNumber = 7;
        }
    }

    function btnMeetingPurpose(optionNumber) {
        console.log('This is option number', optionNumber);
        meetingType = optionNumber;

        if (optionNumber == 1) {
            meetingType = 1;
            $("#btnOptionOne").css({ "backgroundColor": "#17a2b8" });
            $("#btnOptionTwo").css({ "backgroundColor": "#62bcca" });
            $("#btnOptionThree").css({ "backgroundColor": "#62bcca" });
            $("#OtherReason").hide();

        }

        if (optionNumber == 2) {
            meetingType = 2;
            $("#btnOptionOne").css({ "backgroundColor": "#62bcca" });
            $("#btnOptionTwo").css({ "backgroundColor": "#17a2b8" });
            $("#btnOptionThree").css({ "backgroundColor": "#62bcca" });
            $("#OtherReason").hide();
        }

        if (optionNumber == 3) {
            meetingType = 3;
            $("#btnOptionOne").css({ "backgroundColor": "#62bcca" });
            $("#btnOptionTwo").css({ "backgroundColor": "#62bcca" });
            $("#btnOptionThree").css({ "backgroundColor": "#17a2b8" });
            $("#OtherReason").show();
        }


    }

    $("#takePhoto").on('click', function () {
        $("#openFile").click();
    });



    function previewFile(input) {
        var file = $("input[type=file]").get(0).files[0];

        if (file) {
            var reader = new FileReader();

            reader.onload = function () {
                $("#profileImage").attr("src", reader.result);
            }

            reader.readAsDataURL(file);
        }
    }



</script>

